<!-- BURBUJA FLOTANTE -->
<div
  class="fixed bottom-6 right-4 bg-indigo-600 text-white p-4 text-2xl rounded-full cursor-pointer shadow-lg hover:bg-indigo-500 transition"
  (click)="toggleChat()"
>
  ðŸ’¬
</div>

<!-- PANEL DEL CHAT -->
@if (isOpen()) {
<div class="fixed bottom-20 right-5 w-80 h-96 bg-white rounded-lg shadow-xl flex flex-col border border-gray-200 mb-3">
  <!-- Header -->
  <div class="flex justify-between items-center bg-indigo-600 text-white px-3 py-2 rounded-t-lg">
    <span class="font-semibold">Asistente Virtual</span>
    <button (click)="toggleChat()" class="text-xl leading-none">&times;</button>
  </div>

  <!-- Mensajes -->
  <div class="flex-1 overflow-y-auto p-3 space-y-2 bg-gray-50">
    @for (msg of messages(); track msg.from) {
    <div class="text-sm p-2 rounded max-w-[80%]" [ngClass]="{
            'bg-indigo-100 text-indigo-900 self-end ml-auto': msg.from === 'user',
            'bg-gray-200 text-gray-800 self-start mr-auto': msg.from === 'bot'
          }">
      {{ msg.text }}
    </div>
    }
  </div>

  <!-- Input -->
  <div class="p-2 border-t border-gray-300 flex gap-2">
    <input type="text" name="assistant" id="chat"
      class="flex-1 text-sm text-black border border-gray-300 rounded px-2 py-1 bg-white placeholder-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 transition"
      placeholder="Escribe tu mensaje..."
      [(ngModel)]="userMessage"
      (ngModelChange)="userMessage.set($event)"
      (keyup.enter)="sendMessage()" />
    <button class="bg-indigo-600 text-white px-3 py-1 rounded hover:bg-indigo-500 transition text-sm"
      (click)="sendMessage()"
    >
      âž¤
    </button>
  </div>
</div>
}

